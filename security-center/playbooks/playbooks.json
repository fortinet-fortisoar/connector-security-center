{
  "type": "workflow_collections",
  "data": [
    {
      "@type": "WorkflowCollection",
      "name": "Sample - Tenable Security Center - 1.1.0",
      "description": "Sample playbooks for \"Tenable Security Center\" connector. If you are planning to use any of the sample playbooks in your environment, ensure that you clone those playbooks and move them to a different collection, since the sample playbook collection gets deleted during connector upgrade and delete.",
      "visible": true,
      "image": "",
      "uuid": "99c63c4a-fe5d-4141-b391-8f920cdc791b",
      "id": 123,
      "deletedAt": null,
      "importedBy": [],
      "recordTags": [],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "List Asset Vulnerabilities",
          "aliasName": null,
          "tag": "#Security  Center",
          "description": "List vulnerabilities for an individual asset",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1694429729,
          "collection": "/api/3/workflow_collections/99c63c4a-fe5d-4141-b391-8f920cdc791b",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/4ae9073b-c673-4400-8c7b-61bda9a55e69",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "a4074506-b855-41b3-91e7-3d7d991e5d82",
                "title": "SC: List Completed Scan",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": []
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "4ae9073b-c673-4400-8c7b-61bda9a55e69"
            },
            {
              "@type": "WorkflowStep",
              "name": "List Asset Vulnerabilities",
              "description": null,
              "arguments": {
                "name": "Tenable Security Center",
                "config": "4acec183-af5e-4967-b3e8-30feee19c36e",
                "params": {
                  "scan_id": "",
                  "scan_name": "",
                  "asset_info": "1.1.1.1"
                },
                "version": "1.1.0",
                "connector": "security-center",
                "operation": "get_asset_vulns",
                "operationTitle": "List Asset Vulnerabilities",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "bf676d1f-10c0-4f95-99f5-87266cdba505"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> List Assets",
              "targetStep": "/api/3/workflow_steps/bf676d1f-10c0-4f95-99f5-87266cdba505",
              "sourceStep": "/api/3/workflow_steps/4ae9073b-c673-4400-8c7b-61bda9a55e69",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "c40d5ac1-1e49-4b4b-8b13-ba0fe7ca7737"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "1c9c46fa-3536-43b7-b860-95465202cfd8",
          "id": 1689,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "security-center"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "> TenableSecurityCenter  > Fetch",
          "aliasName": null,
          "tag": "#security-center #fetch #dataingestion",
          "description": "This playbook fetch scans and associated assets",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "useMockOutput"
          ],
          "synchronous": false,
          "lastModifyDate": 1694429729,
          "collection": "/api/3/workflow_collections/99c63c4a-fe5d-4141-b391-8f920cdc791b",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/4418fe1c-cb28-4459-9b19-ebabef983685",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Assets Found",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "yes",
                    "step_iri": "/api/3/workflow_steps/e6e15552-eea3-478f-afb8-88ca311a445d",
                    "condition": "{{ vars.asset_records | length > 0 }}",
                    "step_name": "Return Data"
                  },
                  {
                    "option": "no",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/c0e618f7-f921-4957-a775-42746693ae90",
                    "step_name": "Returns No Results"
                  }
                ],
                "step_variables": []
              },
              "status": null,
              "top": "1780",
              "left": "100",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "group": null,
              "uuid": "62f312e6-edef-465f-9969-dd15beeb6895"
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "days": "Last 7 Days",
                "useMockOutput": "False",
                "assets_iri_map": "{}",
                "TenableSecurityCenterMacroName": "TenableSecurityCenterLastPullTime_{{vars['audit_info']['cyops_playbook_iri'].split('/')[-1].replace('-','_')}}"
              },
              "status": null,
              "top": "160",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "93d89bca-9a0d-4692-9760-053373e3a418"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create or Update Scans",
              "description": null,
              "arguments": {
                "arguments": {
                  "scans_list": "{{vars.scans_records}}"
                },
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": false,
                "pass_input_record": false,
                "workflowReference": "/api/3/workflows/ccf4ad7d-4193-4dd9-8ffb-e723620f394b"
              },
              "status": null,
              "top": "980",
              "left": "100",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "ba5102f6-4f3f-4146-9f06-bde065f1bc14"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch Scans",
              "description": null,
              "arguments": {
                "name": "TenableSecurityCenter",
                "config": "14848e3f-bdbb-4a3d-9a54-590face37ce4",
                "params": {
                  "days": "{{vars.last_x_days}}"
                },
                "version": "1.1.0",
                "connector": "security-center",
                "operation": "get_all_scans",
                "mock_result": "{\n    \"data\": {\n      \"message\": \"Records Found\",\n      \"scans_records\": {\n        \"SRVSQLDB3 CIS OS scan\": {\n          \"id\": \"1659\",\n          \"name\": \"SRVSQLDB3 CIS OS scan\",\n          \"owner\": {\n            \"id\": \"6\",\n            \"uuid\": \"B15209FF-B22E-4312-AB90-A0ACECEB466B\",\n            \"lastname\": \"TEST_user\",\n            \"username\": \"TEST_username\",\n            \"firstname\": \"test_firstname\"\n          },\n          \"canUse\": \"true\",\n          \"status\": \"Completed\",\n          \"details\": \"CIS Win SQL server 2016 Database OS\",\n          \"running\": \"false\",\n          \"totalIPs\": \"1\",\n          \"canManage\": \"true\",\n          \"startTime\": \"1692948364\",\n          \"finishTime\": \"1692948615\",\n          \"ownerGroup\": {\n            \"id\": \"0\",\n            \"name\": \"Full Access\",\n            \"description\": \"Full Access group\"\n          },\n          \"repository\": {\n            \"id\": \"1\",\n            \"name\": \"CIB Active Scan Repo\",\n            \"type\": \"Local\",\n            \"uuid\": \"BE3DEDF8-08FA-4014-9308-60915C797249\",\n            \"dataFormat\": \"IPv4\",\n            \"description\": \"repository to save active scan results for CIB network\"\n          },\n          \"resultType\": \"active\",\n          \"scannedIPs\": \"1\",\n          \"createdTime\": \"1692948361\",\n          \"importStart\": \"1692948625\",\n          \"totalChecks\": \"214\",\n          \"completedIPs\": \"1\",\n          \"importFinish\": \"1692948630\",\n          \"importStatus\": \"Finished\",\n          \"resultSource\": \"internal\",\n          \"scanDuration\": \"251\",\n          \"downloadFormat\": \"v2\",\n          \"completedChecks\": \"214\",\n          \"downloadAvailable\": \"true\",\n          \"diagnosticAvailable\": \"false\"\n        },\n        \"TM ApexOneERS VA scan\": {\n          \"id\": \"1658\",\n          \"name\": \"TM ApexOneERS VA scan\",\n          \"owner\": {\n            \"id\": \"6\",\n            \"uuid\": \"B15209FF-B22E-4312-AB90-A0ACECEB466B\",\n            \"lastname\": \"TEST_user\",\n            \"username\": \"TEST_user\",\n            \"firstname\": \"TEST_user\"\n          },\n          \"canUse\": \"true\",\n          \"status\": \"Completed\",\n          \"details\": \"Bisc+Web\",\n          \"running\": \"false\",\n          \"totalIPs\": \"2\",\n          \"canManage\": \"true\",\n          \"startTime\": \"1692870835\",\n          \"finishTime\": \"1692874483\",\n          \"ownerGroup\": {\n            \"id\": \"0\",\n            \"name\": \"Full Access\",\n            \"description\": \"Full Access group\"\n          },\n          \"repository\": {\n            \"id\": \"14\",\n            \"name\": \"Nazaha-Active-AllAssets\",\n            \"type\": \"Local\",\n            \"uuid\": \"35D319E0-625D-431F-A9B9-4C13476247B5\",\n            \"dataFormat\": \"IPv4\",\n            \"description\": \"descriptiion\\n                   +\\nON 04/01/2022:- Added all ips taken from NAZAHA core switch.\"\n          },\n          \"resultType\": \"active\",\n          \"scannedIPs\": \"2\",\n          \"createdTime\": \"1692870827\",\n          \"importStart\": \"1692874494\",\n          \"totalChecks\": \"322700\",\n          \"completedIPs\": \"2\",\n          \"importFinish\": \"1692874502\",\n          \"importStatus\": \"Finished\",\n          \"resultSource\": \"internal\",\n          \"scanDuration\": \"3648\",\n          \"downloadFormat\": \"v2\",\n          \"completedChecks\": \"322700\",\n          \"downloadAvailable\": \"true\",\n          \"diagnosticAvailable\": \"false\"\n        },\n        \"YARA scan Merlin agent CIB USERS\": {\n          \"id\": \"1662\",\n          \"name\": \"YARA scan Merlin agent CIB USERS\",\n          \"owner\": {\n            \"id\": \"6\",\n            \"uuid\": \"B15209FF-B22E-4312-AB90-A0ACECEB466B\",\n            \"lastname\": \"TEST_user\",\n            \"username\": \"TEST_user\",\n            \"firstname\": \"TEST_user\"\n          },\n          \"canUse\": \"true\",\n          \"status\": \"Completed\",\n          \"details\": \"NCA-YARA Scan\",\n          \"running\": \"false\",\n          \"totalIPs\": \"36608\",\n          \"canManage\": \"true\",\n          \"startTime\": \"1692959007\",\n          \"finishTime\": \"1693117672\",\n          \"ownerGroup\": {\n            \"id\": \"0\",\n            \"name\": \"Full Access\",\n            \"description\": \"Full Access group\"\n          },\n          \"repository\": {\n            \"id\": \"13\",\n            \"name\": \"CIB user zone\",\n            \"type\": \"Local\",\n            \"uuid\": \"10199C69-6A2A-4E2A-BA9A-6A45DB71AAE7\",\n            \"dataFormat\": \"IPv4\",\n            \"description\": \"temp for user area\"\n          },\n          \"resultType\": \"active\",\n          \"scannedIPs\": \"36608\",\n          \"createdTime\": \"1692958942\",\n          \"importStart\": \"1693117689\",\n          \"totalChecks\": \"7614464\",\n          \"completedIPs\": \"36712\",\n          \"importFinish\": \"1693117697\",\n          \"importStatus\": \"Finished\",\n          \"resultSource\": \"internal\",\n          \"scanDuration\": \"158665\",\n          \"downloadFormat\": \"v2\",\n          \"completedChecks\": \"7635044\",\n          \"downloadAvailable\": \"true\",\n          \"diagnosticAvailable\": \"false\"\n        },\n        \"CIB Servers-Scheduled Network Scan\": {\n          \"id\": \"1664\",\n          \"name\": \"CIB Servers-Scheduled Network Scan\",\n          \"owner\": {\n            \"id\": \"1\",\n            \"uuid\": \"BB332439-92C0-49E8-BE68-4895519D95D2\",\n            \"lastname\": \"\",\n            \"username\": \"scmanager\",\n            \"firstname\": \"\"\n          },\n          \"canUse\": \"true\",\n          \"status\": \"Completed\",\n          \"details\": \"Basic network scan\",\n          \"running\": \"false\",\n          \"totalIPs\": \"230\",\n          \"canManage\": \"true\",\n          \"startTime\": \"1693225809\",\n          \"finishTime\": \"1693253846\",\n          \"ownerGroup\": {\n            \"id\": \"0\",\n            \"name\": \"Full Access\",\n            \"description\": \"Full Access group\"\n          },\n          \"repository\": {\n            \"id\": \"1\",\n            \"name\": \"CIB Active Scan Repo\",\n            \"type\": \"Local\",\n            \"uuid\": \"BE3DEDF8-08FA-4014-9308-60915C797249\",\n            \"dataFormat\": \"IPv4\",\n            \"description\": \"repository to save active scan results for CIB network\"\n          },\n          \"resultType\": \"active\",\n          \"scannedIPs\": \"230\",\n          \"createdTime\": \"1693225802\",\n          \"importStart\": \"1693253856\",\n          \"totalChecks\": \"36839100\",\n          \"completedIPs\": \"230\",\n          \"importFinish\": \"1693253864\",\n          \"importStatus\": \"Finished\",\n          \"resultSource\": \"internal\",\n          \"scanDuration\": \"28037\",\n          \"downloadFormat\": \"v2\",\n          \"completedChecks\": \"36839100\",\n          \"downloadAvailable\": \"true\",\n          \"diagnosticAvailable\": \"false\"\n        },\n        \"YARA scan Merlin agent CIB servers\": {\n          \"id\": \"1661\",\n          \"name\": \"YARA scan Merlin agent CIB servers\",\n          \"owner\": {\n            \"id\": \"6\",\n            \"uuid\": \"B15209FF-B22E-4312-AB90-A0ACECEB466B\",\n            \"lastname\": \"TEST_user\",\n            \"username\": \"TEST_user\",\n            \"firstname\": \"TEST_user\"\n          },\n          \"canUse\": \"true\",\n          \"status\": \"Completed\",\n          \"details\": \"NCA-YARA Scan\",\n          \"running\": \"false\",\n          \"totalIPs\": \"230\",\n          \"canManage\": \"true\",\n          \"startTime\": \"1692958814\",\n          \"finishTime\": \"1692982698\",\n          \"ownerGroup\": {\n            \"id\": \"0\",\n            \"name\": \"Full Access\",\n            \"description\": \"Full Access group\"\n          },\n          \"repository\": {\n            \"id\": \"1\",\n            \"name\": \"CIB Active Scan Repo\",\n            \"type\": \"Local\",\n            \"uuid\": \"BE3DEDF8-08FA-4014-9308-60915C797249\",\n            \"dataFormat\": \"IPv4\",\n            \"description\": \"repository to save active scan results for CIB network\"\n          },\n          \"resultType\": \"active\",\n          \"scannedIPs\": \"230\",\n          \"createdTime\": \"1692958812\",\n          \"importStart\": \"1692982708\",\n          \"totalChecks\": \"47840\",\n          \"completedIPs\": \"230\",\n          \"importFinish\": \"1692982712\",\n          \"importStatus\": \"Finished\",\n          \"resultSource\": \"internal\",\n          \"scanDuration\": \"23884\",\n          \"downloadFormat\": \"v2\",\n          \"completedChecks\": \"47840\",\n          \"downloadAvailable\": \"true\",\n          \"diagnosticAvailable\": \"false\"\n        }\n      },\n      \"name_id_mapping\": {\n        \"SRVSQLDB3 CIS OS scan\": \"1659\",\n        \"TM ApexOneERS VA scan\": \"1658\",\n        \"YARA scan Merlin agent CIB USERS\": \"1662\",\n        \"CIB Servers-Scheduled Network Scan\": \"1664\",\n        \"YARA scan Merlin agent CIB servers\": \"1661\"\n      }\n    },\n    \"status\": \"Success\",\n    \"message\": \"\",\n    \"operation\": null,\n    \"execution_time\": \"497 ms\"\n  }",
                "operationTitle": "List Completed Scans",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "570",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "604899c4-c6af-4033-86a3-8074adf5fb90"
            },
            {
              "@type": "WorkflowStep",
              "name": "Format Assets Records",
              "description": null,
              "arguments": {
                "asset_records": "{{vars.assets|json_query(\"[].assets[]\")}}"
              },
              "status": null,
              "top": "1640",
              "left": "100",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "8cd33222-24db-4320-a4d3-43f0c24fbf31"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Assets",
              "description": null,
              "arguments": {
                "name": "TenableSecurityCenter",
                "config": "14848e3f-bdbb-4a3d-9a54-590face37ce4",
                "params": {
                  "scan_details": "{{vars.name_id_mapping}}"
                },
                "version": "1.1.0",
                "connector": "security-center",
                "operation": "get_all_assets",
                "mock_result": "{\n  \"data\": {\n    \"assets_records\": [      {\n      \"assets\": [\n        {\n          \"ip\": \"1.1.1.1\",\n          \"uuid\": \"f6927ba6-f512-4b23-b948-5455db6ca74c\",\n          \"osCPE\": \"cpe:/o:microsoft:windows_server_2016:::x64-datacenter\",\n          \"score\": \"16\",\n          \"total\": \"51\",\n          \"tpmID\": \"\",\n          \"dnsName\": \"hostname.domain.com\",\n          \"acrScore\": \"5.0\",\n          \"biosGUID\": \"24AD3B42-6BDC-0D54-6FCA-D5A5B77F8B80\",\n          \"hostUUID\": \"\",\n          \"pluginSet\": \"202308250205\",\n          \"keyDrivers\": \"{\\\"internet exposure\\\":\\\"internal\\\",\\\"device capability\\\":\\\"database_server\\\",\\\"device type\\\":\\\"general_server\\\"}\",\n          \"macAddress\": \"00:50:56:bb:7d:66\",\n          \"mcafeeGUID\": \"\",\n          \"policyName\": \"e2423150-8a56-5dc3-a0d8-9015c5b30ce0-1913812/CIS Win SQL server 2016 Database OS\",\n          \"repository\": {\n            \"id\": -1,\n            \"name\": \"Individual Scan\",\n            \"dataFormat\": \"IPv4\",\n            \"description\": \"\"\n          },\n          \"uniqueness\": \"repositoryID,ip,dnsName\",\n          \"lastAuthRun\": \"1692948603\",\n          \"netbiosName\": \"cib.gov.sa\\\\SQLSERVER\",\n          \"severityLow\": \"0\",\n          \"severityHigh\": \"1\",\n          \"severityInfo\": \"48\",\n          \"lastUnauthRun\": \"1688211963\",\n          \"hostUniqueness\": \"repositoryID,ip,dnsName\",\n          \"severityMedium\": \"2\",\n          \"severityCritical\": \"0\",\n          \"assetExposureScore\": \"691\"\n        }\n      ],\n      \"scan_name\": \"SERVER CIS OS scan\"\n    },\n    {\n      \"assets\": [\n        {\n          \"ip\": \"2.2.2.2\",\n          \"uuid\": \"63affb36-057a-4ba2-a2d9-a4fa5f1fcaf4\",\n          \"osCPE\": \"cpe:/o:microsoft:windows_server_2019\",\n          \"score\": \"938\",\n          \"total\": \"346\",\n          \"tpmID\": \"\",\n          \"dnsName\": \"host2.domain.com\",\n          \"acrScore\": \"5.0\",\n          \"biosGUID\": \"C4CA1A42-8430-12A9-27A7-FF46D3537FF8\",\n          \"hostUUID\": \"\",\n          \"pluginSet\": \"202308240203\",\n          \"keyDrivers\": \"{\\\"internet exposure\\\":\\\"internal\\\",\\\"device capability\\\":\\\"database_server\\\",\\\"device type\\\":\\\"general_server\\\"}\",\n          \"macAddress\": \"00:55:56:9a:8d:F3\",\n          \"mcafeeGUID\": \"\",\n          \"policyName\": \"e2423150-8a56-5dc3-a0d8-9015c5b30ce0-1911522/Bisc+Web\",\n          \"repository\": {\n            \"id\": -1,\n            \"name\": \"Individual Scan\",\n            \"dataFormat\": \"IPv4\",\n            \"description\": \"\"\n          },\n          \"uniqueness\": \"repositoryID,ip,dnsName\",\n          \"lastAuthRun\": \"1692874438\",\n          \"netbiosName\": \"NAZAHA.GOV.SA\\\\APEXONSERVEE\",\n          \"severityLow\": \"4\",\n          \"severityHigh\": \"20\",\n          \"severityInfo\": \"287\",\n          \"lastUnauthRun\": \"1690639844\",\n          \"hostUniqueness\": \"repositoryID,ip,dnsName\",\n          \"severityMedium\": \"18\",\n          \"severityCritical\": \"17\",\n          \"assetExposureScore\": \"689\"\n        },\n        {\n          \"ip\": \"3.3.3.3\",\n          \"uuid\": \"b8761ab2-af18-4001-973a-6a719abcd4f8\",\n          \"osCPE\": \"cpe:/o:microsoft:windows_server_2019\",\n          \"score\": \"953\",\n          \"total\": \"293\",\n          \"tpmID\": \"\",\n          \"dnsName\": \"host3.domain.com\",\n          \"acrScore\": \"5.0\",\n          \"biosGUID\": \"2F671A42-0C23-8418-6D18-9660D77ABF0B\",\n          \"hostUUID\": \"\",\n          \"pluginSet\": \"202308240203\",\n          \"keyDrivers\": \"{\\\"internet exposure\\\":\\\"internal\\\",\\\"device capability\\\":\\\"\\\",\\\"device type\\\":\\\"general_server\\\"}\",\n          \"macAddress\": \"00:50:77:9a:48:6a:3b\",\n          \"mcafeeGUID\": \"\",\n          \"policyName\": \"e2423150-8a56-5dc3-a0d8-9015c5b30ce0-1911522/Bisc+Web\",\n          \"repository\": {\n            \"id\": -1,\n            \"name\": \"Individual Scan\",\n            \"dataFormat\": \"IPv4\",\n            \"description\": \"\"\n          },\n          \"uniqueness\": \"repositoryID,ip,dnsName\",\n          \"lastAuthRun\": \"1692873124\",\n          \"netbiosName\": \"NAZAHA.GOV.SA\\\\SERVER\",\n          \"severityLow\": \"2\",\n          \"severityHigh\": \"18\",\n          \"severityInfo\": \"238\",\n          \"lastUnauthRun\": \"1687609653\",\n          \"hostUniqueness\": \"repositoryID,ip,dnsName\",\n          \"severityMedium\": \"17\",\n          \"severityCritical\": \"18\",\n          \"assetExposureScore\": \"692\"\n        }\n      ],\n      \"scan_name\": \"TM ApexOneERS VA scan\"\n    }\n  ]\n  },\n  \"status\": \"Success\",\n  \"message\": \"\",\n  \"operation\": null,\n  \"execution_time\": \"3 seconds 603 ms\"\n}",
                "operationTitle": "List Assets",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "1240",
              "left": "100",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "2dd50857-d120-4fb6-bfab-5f94be13edfd"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Assets Details",
              "description": null,
              "arguments": {
                "assets": "{{vars.steps.Get_Assets.data['assets_records']}}"
              },
              "status": null,
              "top": "1380",
              "left": "100",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "c868940d-94b1-4e3a-8ce1-2ab1bb15db56"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Macro Value",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/?format=json&name={{vars.TenableSecurityCenterMacroName}}",
                  "body": "",
                  "method": "GET"
                },
                "version": "3.2.4",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "1790f6eb-2b9d-4628-9348-b2caae4d8e35"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Records Count",
              "description": null,
              "arguments": {
                "scans_records": "{{vars.steps.Fetch_Scans.data.scans_records}}"
              },
              "status": null,
              "top": "705",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "5c350651-1cc2-4e6a-b102-1c628a4bb4cd"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Variables",
              "description": null,
              "arguments": {
                "scans_iri_map": "{{vars.steps.Create_or_Update_Scans.scans_iri_map}}",
                "name_id_mapping": "{{vars.steps.Fetch_Scans.data.name_id_mapping}}"
              },
              "status": null,
              "top": "1100",
              "left": "100",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "76c7dc14-073d-415a-94ea-5864b0f0d566"
            },
            {
              "@type": "WorkflowStep",
              "name": "Process Assets Records",
              "description": null,
              "arguments": {
                "_tmp_format_assets": "{% for asset_group in vars.assets %}\n{% for asset in asset_group.assets %}\n{{asset.update({\"scan_name\":asset_group.scan_name})}}\n{% endfor %}\n{% endfor %}"
              },
              "status": null,
              "top": "1520",
              "left": "100",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "ec84d874-d49b-4af8-bbf6-16920fe116ed"
            },
            {
              "@type": "WorkflowStep",
              "name": "Records Returned",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "yes",
                    "step_iri": "/api/3/workflow_steps/ba5102f6-4f3f-4146-9f06-bde065f1bc14",
                    "condition": "{{ vars.scans_records is not none and (vars.scans_records | length) > 0 }}",
                    "step_name": "Create or Update Scans"
                  },
                  {
                    "option": "no",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/c0e618f7-f921-4957-a775-42746693ae90",
                    "step_name": "Returns No Results"
                  }
                ],
                "step_variables": []
              },
              "status": null,
              "top": "840",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "group": null,
              "uuid": "0440517d-f1dd-4169-bd49-078b9095c02a"
            },
            {
              "@type": "WorkflowStep",
              "name": "Return Data",
              "description": null,
              "arguments": {
                "data": "{{vars.asset_records}}",
                "last_x_days": "{{vars.last_x_days}}",
                "source_data": "{\"scans\":{{vars.steps.Fetch_Scans.data}},\"assets\":{{vars.steps.Get_Assets}}}",
                "scans_iri_map": "{{vars.scans_iri_map}}",
                "TenableSecurityCenterMacroName": "{{vars.TenableSecurityCenterMacroName}}"
              },
              "status": null,
              "top": "1920",
              "left": "100",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "e6e15552-eea3-478f-afb8-88ca311a445d"
            },
            {
              "@type": "WorkflowStep",
              "name": "Returns No Results",
              "description": null,
              "arguments": {
                "data": "",
                "TenableSecurityCenterMacroName": "{{vars.TenableSecurityCenterMacroName}}"
              },
              "status": null,
              "top": "1920",
              "left": "620",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "c0e618f7-f921-4957-a775-42746693ae90"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Time Configuration",
              "description": null,
              "arguments": {
                "macro_name": "{{vars.TenableSecurityCenterMacroName}}",
                "last_x_days": "{% if vars.steps.Get_Macro_Value.data['hydra:member'] | length > 0 %}{% if vars.request.env_setup %}{% if not vars.days or vars.days == '' %}Last 7 Days{% else %}{{ vars.days }}{% endif %}{% else %}{{vars.steps.Get_Macro_Value.data['hydra:member'][0]['value']}}{% endif %}{% else %}{% if not vars.days or vars.days == '' %}Last 7 Days{% else %}{{ vars.days }}{% endif %}{% endif %}"
              },
              "status": null,
              "top": "435",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "b1950a3c-57b7-4d07-8bfc-bc1e73062720"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  },
                  "useMockOutput": "True",
                  "_configuration_schema": "[\n    {\n        \"title\": \"Completion Time\",\n        \"type\": \"select\",\n        \"name\": \"days\",\n        \"options\": [\n            \"Last Fetch\",\n            \"Last 24 Hours\",\n            \"Last 3 Days\",\n            \"Last 5 Days\",\n            \"Last 7 Days\",\n            \"Last 15 Days\",\n            \"Last 25 Days\",\n            \"Last 30 Days\",\n            \"Last 50 Days\",\n            \"Last 60 Days\",\n            \"Last 90 Days\",\n            \"Last 120 Days\",\n            \"Last 180 Days\"\n        ],\n        \"required\": true,\n        \"editable\": true,\n        \"visible\": true,\n        \"tooltip\": \"Fetch records from last X days. e.g 7\",\n        \"value\": \"Last 7 Days\"\n    }\n]"
                }
              },
              "status": null,
              "top": "20",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "4418fe1c-cb28-4459-9b19-ebabef983685"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Assets Found -> Return Data",
              "targetStep": "/api/3/workflow_steps/e6e15552-eea3-478f-afb8-88ca311a445d",
              "sourceStep": "/api/3/workflow_steps/62f312e6-edef-465f-9969-dd15beeb6895",
              "label": "yes",
              "isExecuted": false,
              "group": null,
              "uuid": "78816f92-20e2-4207-b069-450de99f1cff"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Assets Found -> Returns No Results",
              "targetStep": "/api/3/workflow_steps/c0e618f7-f921-4957-a775-42746693ae90",
              "sourceStep": "/api/3/workflow_steps/62f312e6-edef-465f-9969-dd15beeb6895",
              "label": "no",
              "isExecuted": false,
              "group": null,
              "uuid": "48ffc556-40bc-4689-86a5-305c26c014c6"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Compute Pages -> Fetch Incidents",
              "targetStep": "/api/3/workflow_steps/2dd50857-d120-4fb6-bfab-5f94be13edfd",
              "sourceStep": "/api/3/workflow_steps/76c7dc14-073d-415a-94ea-5864b0f0d566",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "ab8adecf-9398-4740-8527-204d5138f025"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Get Macro Value",
              "targetStep": "/api/3/workflow_steps/1790f6eb-2b9d-4628-9348-b2caae4d8e35",
              "sourceStep": "/api/3/workflow_steps/93d89bca-9a0d-4692-9760-053373e3a418",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "7372c452-1fcd-49e7-bc19-906bfae1ee71"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create or Update Scans -> Get Name ID Mapping",
              "targetStep": "/api/3/workflow_steps/76c7dc14-073d-415a-94ea-5864b0f0d566",
              "sourceStep": "/api/3/workflow_steps/ba5102f6-4f3f-4146-9f06-bde065f1bc14",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "087f059e-8737-452c-b5c2-11e93d8273da"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Fetch Incident -> Get Records Count",
              "targetStep": "/api/3/workflow_steps/5c350651-1cc2-4e6a-b102-1c628a4bb4cd",
              "sourceStep": "/api/3/workflow_steps/604899c4-c6af-4033-86a3-8074adf5fb90",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "12ac023a-964b-42a3-bad1-5205a00c45f6"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Format Assets Records -> Assets Found",
              "targetStep": "/api/3/workflow_steps/62f312e6-edef-465f-9969-dd15beeb6895",
              "sourceStep": "/api/3/workflow_steps/8cd33222-24db-4320-a4d3-43f0c24fbf31",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "a688bea0-4883-4bf2-9cb8-7f5ca23b7c7f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Assets Details -> Copy of Get Assets Details",
              "targetStep": "/api/3/workflow_steps/ec84d874-d49b-4af8-bbf6-16920fe116ed",
              "sourceStep": "/api/3/workflow_steps/c868940d-94b1-4e3a-8ce1-2ab1bb15db56",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "7f90e71c-5678-4248-9421-c1fe772e2f8a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Assets -> Get Assets Details",
              "targetStep": "/api/3/workflow_steps/c868940d-94b1-4e3a-8ce1-2ab1bb15db56",
              "sourceStep": "/api/3/workflow_steps/2dd50857-d120-4fb6-bfab-5f94be13edfd",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "8d81feb3-2677-44aa-a1d7-dae8c29ad323"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Macro Value -> Set Time Configuration",
              "targetStep": "/api/3/workflow_steps/b1950a3c-57b7-4d07-8bfc-bc1e73062720",
              "sourceStep": "/api/3/workflow_steps/1790f6eb-2b9d-4628-9348-b2caae4d8e35",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "33c656d1-93a8-4db8-b7d0-2372b6de1391"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Records Count -> Records Returned",
              "targetStep": "/api/3/workflow_steps/0440517d-f1dd-4169-bd49-078b9095c02a",
              "sourceStep": "/api/3/workflow_steps/5c350651-1cc2-4e6a-b102-1c628a4bb4cd",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "dd42c68d-0d6c-431a-a188-42a7f88fa441"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Process Assets Records -> Copy of Process Assets Records",
              "targetStep": "/api/3/workflow_steps/8cd33222-24db-4320-a4d3-43f0c24fbf31",
              "sourceStep": "/api/3/workflow_steps/ec84d874-d49b-4af8-bbf6-16920fe116ed",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "a8839032-1bd6-417e-8abe-7f297c5919e9"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Records Returned -> Create or Update Scans",
              "targetStep": "/api/3/workflow_steps/ba5102f6-4f3f-4146-9f06-bde065f1bc14",
              "sourceStep": "/api/3/workflow_steps/0440517d-f1dd-4169-bd49-078b9095c02a",
              "label": "yes",
              "isExecuted": false,
              "group": null,
              "uuid": "229487d1-24e3-45aa-8e30-345cafa32321"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Records Returned -> Returns No Results",
              "targetStep": "/api/3/workflow_steps/c0e618f7-f921-4957-a775-42746693ae90",
              "sourceStep": "/api/3/workflow_steps/0440517d-f1dd-4169-bd49-078b9095c02a",
              "label": "no",
              "isExecuted": false,
              "group": null,
              "uuid": "ca706418-f367-46c3-b9ee-54c6ae3df3d2"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Time Configuration -> Fetch Incident",
              "targetStep": "/api/3/workflow_steps/604899c4-c6af-4033-86a3-8074adf5fb90",
              "sourceStep": "/api/3/workflow_steps/b1950a3c-57b7-4d07-8bfc-bc1e73062720",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "a4e0f646-8582-41d7-88cb-81353513ae79"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/93d89bca-9a0d-4692-9760-053373e3a418",
              "sourceStep": "/api/3/workflow_steps/4418fe1c-cb28-4459-9b19-ebabef983685",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "c86ba6a8-7777-4e6d-9edd-eb0ad3a33e8e"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "260009b3-c48d-4aeb-8220-92197833194e",
          "id": 1690,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "fetch",
            "security-center"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "List Assets",
          "aliasName": null,
          "tag": "#Security  Center",
          "description": "List assets associated with particular scans",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1694429729,
          "collection": "/api/3/workflow_collections/99c63c4a-fe5d-4141-b391-8f920cdc791b",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/e7f6dba8-0045-4eaf-88fc-810354abd706",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "07957881-2d81-4a11-99f4-7fbd8a133469",
                "title": "SC: List Completed Scan",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": []
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "e7f6dba8-0045-4eaf-88fc-810354abd706"
            },
            {
              "@type": "WorkflowStep",
              "name": "List Assets",
              "description": null,
              "arguments": {
                "name": "Tenable Security Center",
                "config": "4acec183-af5e-4967-b3e8-30feee19c36e",
                "params": {
                  "scan_details": "{\"scan name\":23452345}"
                },
                "version": "1.1.0",
                "connector": "security-center",
                "operation": "get_all_assets",
                "operationTitle": "List Assets",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "f02c1cac-ec38-49b3-b78a-49047eaefa88"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> List Assets",
              "targetStep": "/api/3/workflow_steps/f02c1cac-ec38-49b3-b78a-49047eaefa88",
              "sourceStep": "/api/3/workflow_steps/e7f6dba8-0045-4eaf-88fc-810354abd706",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "e3adbf7e-57ac-47dd-813e-11e219df53b3"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "3ffddf98-f840-45d3-af7e-155c10cc3687",
          "id": 1691,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "security-center"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": ">> Create or Update Assets",
          "aliasName": null,
          "tag": "#security-center #dataingestion",
          "description": "Creates new assets and updates existing ones",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "assets_list",
            "scans_iri_map"
          ],
          "synchronous": false,
          "lastModifyDate": 1694429729,
          "collection": "/api/3/workflow_collections/99c63c4a-fe5d-4141-b391-8f920cdc791b",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/38d89dbd-fd8e-49c7-bb2d-fed238c04209",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Compute Assets IRI map",
              "description": null,
              "arguments": {
                "_compute_map": "{% for asset in vars.steps.Create_or_Update_Assets %}\n{{vars.assets_iri_map.update({asset.ip:asset[\"@id\"]})}}\n{% endfor %}"
              },
              "status": null,
              "top": "435",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "43632138-9d47-4588-ad61-3d67615d815f"
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "assets": "{{vars.input.params.assets_list.assets}}",
                "scan_name": "{{vars.input.params.assets_list.scan_name}}",
                "scans_iri_map": "{{vars.input.params['scans_iri_map']}}",
                "assets_iri_map": "{}"
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "103b01b0-bdc6-48b0-8c90-f52612ecac9f"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create or Update Assets",
              "description": null,
              "arguments": {
                "when": "{{vars.assets | length > 0}}",
                "for_each": {
                  "item": "{{vars.assets}}",
                  "__bulk": true,
                  "parallel": false,
                  "condition": "",
                  "batch_size": 100
                },
                "resource": {
                  "ip": "{{vars.item.ip}}",
                  "name": "{{vars.item.netbiosName}}",
                  "__link": {
                    "scans": "{{vars.scans_iri_map[vars.scan_name]}}"
                  },
                  "firmware": "{{vars.item.osCPE}}",
                  "hostname": "{{vars.item.dnsName}}",
                  "__replace": "true",
                  "assetType": "/api/3/picklists/7630b182-4930-4f97-beec-3c3a5372cb3b",
                  "deviceUid": "{{vars.item.uuid}}",
                  "macAddress": "{{vars.item.macAddress}}",
                  "recordTags": [
                    "/api/3/tags/Tenable"
                  ],
                  "sourceData": "{{vars.item|toJSON}}",
                  "criticality": "{% if vars.item.severityCritical|int == 0 %}{{\"Criticality\" | picklist(\"None\", \"@id\")}}{%elif 5 < vars.item.severityCritical|int <= 5 %}{{\"Criticality\" | picklist(\"Low\", \"@id\")}}{%elif 5 < vars.item.severityCritical|int <= 10 %}{{\"Criticality\" | picklist(\"Medium\", \"@id\")}}{%elif 10 < vars.item.severityCritical|int <= 15 %}{{\"Criticality\" | picklist(\"High\", \"@id\")}}{%elif 15 < vars.item.severityCritical|int <= 18 %}{{\"Criticality\" | picklist(\"Critical\", \"@id\")}}{%elif vars.item.severityCritical|int > 18 %}{{\"Criticality\" | picklist(\"Very Critical\", \"@id\")}}{% endif %}",
                  "dateScanned": "{{vars.item.lastAuthRun|int or vars.item.lastUnauthRun|int}}",
                  "description": "{{vars.item | json2html(row_fields=[\"dnsName\",\"ip\",\"macAddress\",\"osCPE\",\"netbiosName\",\"biosGUID\"], display=\"Vertical\")}}",
                  "__fieldsToUpdate": [
                    "dateScanned",
                    "criticality"
                  ]
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "/api/3/upsert/assets",
                "__recommend": [],
                "fieldOperation": {
                  "protocol": "Overwrite",
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "group": null,
              "uuid": "0354a5b8-926a-456e-a173-4e26c24b7ba9"
            },
            {
              "@type": "WorkflowStep",
              "name": "Return Data",
              "description": null,
              "arguments": {
                "assets_iri_map": "{{vars.assets_iri_map}}"
              },
              "status": null,
              "top": "570",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "99a255c2-eefc-4d1c-b9aa-04c37a41f162"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "38d89dbd-fd8e-49c7-bb2d-fed238c04209"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Compute Scan IRIs -> Return Data",
              "targetStep": "/api/3/workflow_steps/99a255c2-eefc-4d1c-b9aa-04c37a41f162",
              "sourceStep": "/api/3/workflow_steps/43632138-9d47-4588-ad61-3d67615d815f",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "0e7200dc-1da5-4d5b-be51-bd18b4662019"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Create",
              "targetStep": "/api/3/workflow_steps/0354a5b8-926a-456e-a173-4e26c24b7ba9",
              "sourceStep": "/api/3/workflow_steps/103b01b0-bdc6-48b0-8c90-f52612ecac9f",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "c41d16e3-d748-4396-b34a-106fb1073d20"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create -> Compute Results",
              "targetStep": "/api/3/workflow_steps/43632138-9d47-4588-ad61-3d67615d815f",
              "sourceStep": "/api/3/workflow_steps/0354a5b8-926a-456e-a173-4e26c24b7ba9",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "9f10c300-a6b2-4c73-9f22-5763124c9319"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/103b01b0-bdc6-48b0-8c90-f52612ecac9f",
              "sourceStep": "/api/3/workflow_steps/38d89dbd-fd8e-49c7-bb2d-fed238c04209",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "2cc2926c-0b00-4970-bb08-be21e62500a2"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "53f03aad-ef60-485b-a1a6-58e78417d87e",
          "id": 1692,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "security-center"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "> Create or Update Vulnerabilities",
          "aliasName": null,
          "tag": "#security-center #dataingestion",
          "description": "Creates new vulnerabilities and updates existing ones",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "asset",
            "useMockOutput"
          ],
          "synchronous": false,
          "lastModifyDate": 1694429729,
          "collection": "/api/3/workflow_collections/99c63c4a-fe5d-4141-b391-8f920cdc791b",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/9b81220c-ee95-4420-9f17-5b9c2d6e1bab",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Compute Vulnerabilities List",
              "description": null,
              "arguments": {
                "vulnerabilities": "{{vars.steps.Get_Vulnerabilities.data['vulns_data']}}"
              },
              "status": null,
              "top": "570",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "ca7ef5fd-2d16-4fbc-890a-c4053c810627"
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "asset_iri": "{{vars.input.params.asset[\"@id\"]}}",
                "source_data": "{{vars.input.params.asset.sourceData|toDict}}",
                "severity_map": "{\n\"Critical\":\"Critical\",\n\"High\":\"High\",\n\"Medium\":\"Medium\",\n\"Low\":\"Low\",\n\"Info\":\"Minimal\"\n}"
              },
              "status": null,
              "top": "165",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "613e0712-c551-4ed6-aa34-5091a7f2da14"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Vulnerabilities Records",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.vulnerabilities}}",
                  "__bulk": true,
                  "parallel": false,
                  "condition": "",
                  "batch_size": 100
                },
                "resource": {
                  "name": "{{vars.item.synopsis}}",
                  "risk": "{{vars.item.riskFactor}}",
                  "cveId": "{{vars.item.cve}}",
                  "__link": {
                    "assets": "{{vars.asset_iri}}"
                  },
                  "status": "/api/3/picklists/e001be1d-d050-473c-a82d-003bf14c4b1b",
                  "severity": "{{\"Severity\" | picklist(vars.severity_map[vars.item.severity.name], \"@id\")}}",
                  "__replace": "true",
                  "iPAddress": "{{vars.item.ip}}",
                  "riskScore": "{{vars.item.acrScore}}",
                  "cvssVector": "{{vars.item.cvssVector}}",
                  "pluginName": "{{vars.item.pluginName}}",
                  "pluginType": "{{vars.item.pluginText}}",
                  "recordTags": [
                    "/api/3/tags/Tenable"
                  ],
                  "sourceData": "{{vars.item|toJSON}}",
                  "cvss3Vector": "{{vars.item.cvssV3Vector}}",
                  "description": "- {{vars.item.synopsis}}\n- {{vars.item.description}}\n- {{vars.item.operatingSystem}}",
                  "lastSeenDate": "{{vars.item.lastSeen|int}}",
                  "pluginFamily": "{{vars.item.family.name}}",
                  "exploitSkills": "{{vars.item.exploitEase}}",
                  "firstSeenDate": "{{vars.item.firstSeen|int}}",
                  "pluginVersion": "{{vars.item.version}}",
                  "publishedDate": "{{vars.item.vulnPubDate|int|abs}}",
                  "cvss3BaseScore": "{{vars.item.cvssV3BaseScore}}",
                  "vulnerabilityId": "{{vars.item.pluginID}}",
                  "__fieldsToUpdate": [
                    "lastSeenDate",
                    "severity"
                  ],
                  "cvssTemporalScore": "{{vars.item.temporalScore}}",
                  "cvss3TemporalScore": "{{vars.item.cvssV3TemporalScore}}",
                  "pluginPublicationDate": "{{vars.item.pluginPubDate}}"
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "/api/3/upsert/vulnerabilities",
                "__recommend": [],
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "705",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "group": null,
              "uuid": "95e4adce-e4dd-4b28-b63b-b91d86f978f6"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Vulnerabilities",
              "description": null,
              "arguments": {
                "name": "Tenable Security Center",
                "config": "d086f8c3-a066-4e4c-a72f-417bfe12a748",
                "params": {
                  "scan_id": "",
                  "scan_name": "{{vars.scan_name}}",
                  "asset_info": "{{vars.asset_ip}}"
                },
                "version": "1.1.0",
                "connector": "security-center",
                "operation": "get_asset_vulns",
                "mock_result": "{\n    \"data\": {\n        \"message\": \"Records Found\",\n        \"vulns_data\": [\n            {\n                \"ip\": \"{{vars.asset_ip}}\",\n                \"bid\": \"\",\n                \"cpe\": \"\",\n                \"cve\": \"\",\n                \"ips\": \"{{vars.asset_ip}}\",\n                \"port\": \"5985\",\n                \"uuid\": \"f6927ba6-f512-4b23-b948-5455db6ca74c\",\n                \"xref\": \"IAVT #0001-T-0931\",\n                \"family\": {\n                    \"id\": \"11\",\n                    \"name\": \"Web Servers\",\n                    \"type\": \"active\"\n                },\n                \"dnsName\": \"server.dns1\",\n                \"seeAlso\": \"\",\n                \"version\": \"1.141\",\n                \"acrScore\": \"5.0\",\n                \"hostUUID\": \"\",\n                \"lastSeen\": \"1693253858\",\n                \"pluginID\": \"10107\",\n                \"protocol\": \"TCP\",\n                \"severity\": {\n                    \"id\": \"0\",\n                    \"name\": \"Info\",\n                    \"description\": \"Informative\"\n                },\n                \"solution\": \"\",\n                \"synopsis\": \"A web server is running on the remote host.\",\n                \"vprScore\": \"\",\n                \"baseScore\": \"\",\n                \"checkType\": \"remote\",\n                \"firstSeen\": \"1638902227\",\n                \"acceptRisk\": \"0\",\n                \"cvssVector\": \"\",\n                \"keyDrivers\": \"{\\\"internet exposure\\\":\\\"internal\\\",\\\"device capability\\\":\\\"database_server\\\",\\\"device type\\\":\\\"general_server\\\"}\",\n                \"macAddress\": \"00:50:56:bb:7d:95\",\n                \"pluginInfo\": \"10107 (5985/6) HTTP Server Type and Version\",\n                \"pluginName\": \"HTTP Server Type and Version\",\n                \"pluginText\": \"<plugin_output>The remote web server type is :\\n\\nMicrosoft-HTTPAPI/2.0</plugin_output>\",\n                \"recastRisk\": \"0\",\n                \"repository\": {\n                    \"id\": \"1\",\n                    \"name\": \"CIB Active Scan Repo\",\n                    \"dataFormat\": \"IPv4\",\n                    \"description\": \"repository to save active scan results for CIB network\"\n                },\n                \"riskFactor\": \"None\",\n                \"uniqueness\": \"repositoryID,ip,dnsName\",\n                \"vprContext\": \"[]\",\n                \"description\": \"This plugin attempts to determine the type and the version of the   remote web server.\",\n                \"exploitEase\": \"\",\n                \"netbiosName\": \"cib.gov.sa\\\\SQLServer\",\n                \"vulnPubDate\": \"-1\",\n                \"cvssV3Vector\": \"\",\n                \"patchPubDate\": \"-1\",\n                \"stigSeverity\": \"\",\n                \"pluginModDate\": \"1604059200\",\n                \"pluginPubDate\": \"946987200\",\n                \"temporalScore\": \"\",\n                \"hostUniqueness\": \"repositoryID,ip,dnsName\",\n                \"cvssV3BaseScore\": \"\",\n                \"operatingSystem\": \"Microsoft Windows Server 2016 Datacenter Build 14393\",\n                \"exploitAvailable\": \"No\",\n                \"hasBeenMitigated\": \"0\",\n                \"exploitFrameworks\": \"\",\n                \"assetExposureScore\": \"691\",\n                \"cvssV3TemporalScore\": \"\",\n                \"acceptRiskRuleComment\": \"\",\n                \"recastRiskRuleComment\": \"\"\n            },\n            {\n                \"ip\": \"{{vars.asset_ip}}\",\n                \"bid\": \"\",\n                \"cpe\": \"\",\n                \"cve\": \"\",\n                \"ips\": \"{{vars.asset_ip}}\",\n                \"port\": \"47001\",\n                \"uuid\": \"f6927ba6-f512-4b23-b948-5455db6ca74c\",\n                \"xref\": \"IAVT #0001-T-0931\",\n                \"family\": {\n                    \"id\": \"11\",\n                    \"name\": \"Web Servers\",\n                    \"type\": \"active\"\n                },\n                \"dnsName\": \"SERVERDSN2\",\n                \"seeAlso\": \"\",\n                \"version\": \"1.141\",\n                \"acrScore\": \"5.0\",\n                \"hostUUID\": \"\",\n                \"lastSeen\": \"1693253858\",\n                \"pluginID\": \"10108\",\n                \"protocol\": \"TCP\",\n                \"severity\": {\n                    \"id\": \"0\",\n                    \"name\": \"Info\",\n                    \"description\": \"Informative\"\n                },\n                \"solution\": \"\",\n                \"synopsis\": \"A web server is running on the remote host.\",\n                \"vprScore\": \"\",\n                \"baseScore\": \"\",\n                \"checkType\": \"remote\",\n                \"firstSeen\": \"1638902227\",\n                \"acceptRisk\": \"0\",\n                \"cvssVector\": \"\",\n                \"keyDrivers\": \"{\\\"internet exposure\\\":\\\"internal\\\",\\\"device capability\\\":\\\"database_server\\\",\\\"device type\\\":\\\"general_server\\\"}\",\n                \"macAddress\": \"00:50:56:bb:7d:44\",\n                \"pluginInfo\": \"10107 (47001/6) HTTP Server Type and Version\",\n                \"pluginName\": \"HTTP Server Type and Version\",\n                \"pluginText\": \"<plugin_output>The remote web server type is :\\n\\nMicrosoft-HTTPAPI/2.0</plugin_output>\",\n                \"recastRisk\": \"0\",\n                \"repository\": {\n                    \"id\": \"1\",\n                    \"name\": \"CIB Active Scan Repo\",\n                    \"dataFormat\": \"IPv4\",\n                    \"description\": \"repository to save active scan results for CIB network\"\n                },\n                \"riskFactor\": \"None\",\n                \"uniqueness\": \"repositoryID,ip,dnsName\",\n                \"vprContext\": \"[]\",\n                \"description\": \"This plugin attempts to determine the type and the version of the   remote web server.\",\n                \"exploitEase\": \"\",\n                \"netbiosName\": \"cib.gov.sa\\\\SRVSQLDB3\",\n                \"vulnPubDate\": \"-1\",\n                \"cvssV3Vector\": \"\",\n                \"patchPubDate\": \"-1\",\n                \"stigSeverity\": \"\",\n                \"pluginModDate\": \"1604059200\",\n                \"pluginPubDate\": \"946987200\",\n                \"temporalScore\": \"\",\n                \"hostUniqueness\": \"repositoryID,ip,dnsName\",\n                \"cvssV3BaseScore\": \"\",\n                \"operatingSystem\": \"Microsoft Windows Server 2016 Datacenter Build 14393\",\n                \"exploitAvailable\": \"No\",\n                \"hasBeenMitigated\": \"0\",\n                \"exploitFrameworks\": \"\",\n                \"assetExposureScore\": \"691\",\n                \"cvssV3TemporalScore\": \"\",\n                \"acceptRiskRuleComment\": \"\",\n                \"recastRiskRuleComment\": \"\"\n            },\n            {\n                \"ip\": \"{{vars.asset_ip}}\",\n                \"bid\": \"\",\n                \"cpe\": \"\",\n                \"cve\": \"CVE-1999-0524\",\n                \"ips\": \"{{vars.asset_ip}}\",\n                \"port\": \"0\",\n                \"uuid\": \"f6927ba6-f512-4b23-b948-5455db6ca74c\",\n                \"xref\": \"CWE #200\",\n                \"family\": {\n                    \"id\": \"30\",\n                    \"name\": \"General\",\n                    \"type\": \"active\"\n                },\n                \"dnsName\": \"serverDSN3\",\n                \"seeAlso\": \"\",\n                \"version\": \"1.49\",\n                \"acrScore\": \"5.0\",\n                \"hostUUID\": \"\",\n                \"lastSeen\": \"1693253858\",\n                \"pluginID\": \"10114\",\n                \"protocol\": \"ICMP\",\n                \"severity\": {\n                    \"id\": \"0\",\n                    \"name\": \"Info\",\n                    \"description\": \"Informative\"\n                },\n                \"solution\": \"Filter out the ICMP timestamp requests (13), and the outgoing ICMP timestamp replies (14).\",\n                \"synopsis\": \"It is possible to determine the exact time set on the remote host.\",\n                \"vprScore\": \"0.8\",\n                \"baseScore\": \"0.0\",\n                \"checkType\": \"remote\",\n                \"firstSeen\": \"1638902227\",\n                \"acceptRisk\": \"0\",\n                \"cvssVector\": \"AV:L/AC:L/Au:N/C:N/I:N/A:N\",\n                \"keyDrivers\": \"{\\\"internet exposure\\\":\\\"internal\\\",\\\"device capability\\\":\\\"database_server\\\",\\\"device type\\\":\\\"general_server\\\"}\",\n                \"macAddress\": \"00:50:56:bb:7d:95\",\n                \"pluginInfo\": \"10114 (0/1) ICMP Timestamp Request Remote Date Disclosure\",\n                \"pluginName\": \"ICMP Timestamp Request Remote Date Disclosure\",\n                \"pluginText\": \"<plugin_output>This host returns non-standard timestamps (high bit is set)\\nThe ICMP timestamps might be in little endian format (not in network format)\\nThe remote clock is synchronized with the local clock.\\n</plugin_output>\",\n                \"recastRisk\": \"0\",\n                \"repository\": {\n                    \"id\": \"1\",\n                    \"name\": \"CIB Active Scan Repo\",\n                    \"dataFormat\": \"IPv4\",\n                    \"description\": \"repository to save active scan results for CIB network\"\n                },\n                \"riskFactor\": \"None\",\n                \"uniqueness\": \"repositoryID,ip,dnsName\",\n                \"vprContext\": \"[{\\\"id\\\":\\\"age_of_vuln\\\",\\\"name\\\":\\\"Vulnerability Age\\\",\\\"type\\\":\\\"string\\\",\\\"value\\\":\\\"730 days +\\\"},{\\\"id\\\":\\\"cvssV3_impactScore\\\",\\\"name\\\":\\\"CVSS v3 Impact Score\\\",\\\"type\\\":\\\"number\\\",\\\"value\\\":0},{\\\"id\\\":\\\"exploit_code_maturity\\\",\\\"name\\\":\\\"Exploit Code Maturity\\\",\\\"type\\\":\\\"string\\\",\\\"value\\\":\\\"Unproven\\\"},{\\\"id\\\":\\\"product_coverage\\\",\\\"name\\\":\\\"Product Coverage\\\",\\\"type\\\":\\\"string\\\",\\\"value\\\":\\\"Very High\\\"},{\\\"id\\\":\\\"threat_intensity_last_28\\\",\\\"name\\\":\\\"Threat Intensity\\\",\\\"type\\\":\\\"string\\\",\\\"value\\\":\\\"Very Low\\\"},{\\\"id\\\":\\\"threat_recency\\\",\\\"name\\\":\\\"Threat Recency\\\",\\\"type\\\":\\\"string\\\",\\\"value\\\":\\\"No recorded events\\\"},{\\\"id\\\":\\\"threat_sources_last_28\\\",\\\"name\\\":\\\"Threat Sources\\\",\\\"type\\\":\\\"string\\\",\\\"value\\\":\\\"No recorded events\\\"}]\",\n                \"description\": \"The remote host answers to an ICMP timestamp request.  This allows an attacker to know the date that is set on the targeted machine, which may assist an unauthenticated, remote attacker in defeating time-based authentication protocols.\\n\\nTimestamps returned from machines running Windows Vista / 7 / 2008 / 2008 R2 are deliberately incorrect, but usually within 1000 seconds of the actual system time.\",\n                \"exploitEase\": \"\",\n                \"netbiosName\": \"cib.gov.sa\\\\SRVSQLDB3\",\n                \"vulnPubDate\": \"788961600\",\n                \"cvssV3Vector\": \"AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N\",\n                \"patchPubDate\": \"-1\",\n                \"stigSeverity\": \"\",\n                \"pluginModDate\": \"1682596800\",\n                \"pluginPubDate\": \"933508800\",\n                \"temporalScore\": \"\",\n                \"hostUniqueness\": \"repositoryID,ip,dnsName\",\n                \"cvssV3BaseScore\": \"0.0\",\n                \"operatingSystem\": \"Microsoft Windows Server 2016 Datacenter Build 14393\",\n                \"exploitAvailable\": \"No\",\n                \"hasBeenMitigated\": \"0\",\n                \"exploitFrameworks\": \"\",\n                \"assetExposureScore\": \"691\",\n                \"cvssV3TemporalScore\": \"\",\n                \"acceptRiskRuleComment\": \"\",\n                \"recastRiskRuleComment\": \"\"\n            },\n            {\n                \"ip\": \"1.1.1.1\",\n                \"bid\": \"\",\n                \"cpe\": \"\",\n                \"cve\": \"CVE-1999-0524\",\n                \"ips\": \"1.1.1.1\",\n                \"port\": \"0\",\n                \"uuid\": \"f6927ba6-f512-4b23-b948-5455db6ca74c\",\n                \"xref\": \"CWE #200\",\n                \"family\": {\n                    \"id\": \"30\",\n                    \"name\": \"General\",\n                    \"type\": \"active\"\n                },\n                \"dnsName\": \"serverDSN3\",\n                \"seeAlso\": \"\",\n                \"version\": \"1.49\",\n                \"acrScore\": \"5.0\",\n                \"hostUUID\": \"\",\n                \"lastSeen\": \"1693253858\",\n                \"pluginID\": \"10115\",\n                \"protocol\": \"ICMP\",\n                \"severity\": {\n                    \"id\": \"0\",\n                    \"name\": \"Info\",\n                    \"description\": \"Informative\"\n                },\n                \"solution\": \"Filter out the ICMP timestamp requests (13), and the outgoing ICMP timestamp replies (14).\",\n                \"synopsis\": \"It is possible to determine the exact time set on the remote host.\",\n                \"vprScore\": \"0.8\",\n                \"baseScore\": \"0.0\",\n                \"checkType\": \"remote\",\n                \"firstSeen\": \"1638902227\",\n                \"acceptRisk\": \"0\",\n                \"cvssVector\": \"AV:L/AC:L/Au:N/C:N/I:N/A:N\",\n                \"keyDrivers\": \"{\\\"internet exposure\\\":\\\"internal\\\",\\\"device capability\\\":\\\"database_server\\\",\\\"device type\\\":\\\"general_server\\\"}\",\n                \"macAddress\": \"00:50:56:bb:7d:95\",\n                \"pluginInfo\": \"10115 (0/1) ICMP Timestamp Request Remote Date Disclosure\",\n                \"pluginName\": \"ICMP Timestamp Request Remote Date Disclosure\",\n                \"pluginText\": \"<plugin_output>This host returns non-standard timestamps (high bit is set)\\nThe ICMP timestamps might be in little endian format (not in network format)\\nThe remote clock is synchronized with the local clock.\\n</plugin_output>\",\n                \"recastRisk\": \"0\",\n                \"repository\": {\n                    \"id\": \"1\",\n                    \"name\": \"CIB Active Scan Repo\",\n                    \"dataFormat\": \"IPv4\",\n                    \"description\": \"repository to save active scan results for CIB network\"\n                },\n                \"riskFactor\": \"None\",\n                \"uniqueness\": \"repositoryID,ip,dnsName\",\n                \"vprContext\": \"[{\\\"id\\\":\\\"age_of_vuln\\\",\\\"name\\\":\\\"Vulnerability Age\\\",\\\"type\\\":\\\"string\\\",\\\"value\\\":\\\"730 days +\\\"},{\\\"id\\\":\\\"cvssV3_impactScore\\\",\\\"name\\\":\\\"CVSS v3 Impact Score\\\",\\\"type\\\":\\\"number\\\",\\\"value\\\":0},{\\\"id\\\":\\\"exploit_code_maturity\\\",\\\"name\\\":\\\"Exploit Code Maturity\\\",\\\"type\\\":\\\"string\\\",\\\"value\\\":\\\"Unproven\\\"},{\\\"id\\\":\\\"product_coverage\\\",\\\"name\\\":\\\"Product Coverage\\\",\\\"type\\\":\\\"string\\\",\\\"value\\\":\\\"Very High\\\"},{\\\"id\\\":\\\"threat_intensity_last_28\\\",\\\"name\\\":\\\"Threat Intensity\\\",\\\"type\\\":\\\"string\\\",\\\"value\\\":\\\"Very Low\\\"},{\\\"id\\\":\\\"threat_recency\\\",\\\"name\\\":\\\"Threat Recency\\\",\\\"type\\\":\\\"string\\\",\\\"value\\\":\\\"No recorded events\\\"},{\\\"id\\\":\\\"threat_sources_last_28\\\",\\\"name\\\":\\\"Threat Sources\\\",\\\"type\\\":\\\"string\\\",\\\"value\\\":\\\"No recorded events\\\"}]\",\n                \"description\": \"The remote host answers to an ICMP timestamp request.  This allows an attacker to know the date that is set on the targeted machine, which may assist an unauthenticated, remote attacker in defeating time-based authentication protocols.\\n\\nTimestamps returned from machines running Windows Vista / 7 / 2008 / 2008 R2 are deliberately incorrect, but usually within 1000 seconds of the actual system time.\",\n                \"exploitEase\": \"\",\n                \"netbiosName\": \"cib.gov.sa\\\\SRVSQLDB3\",\n                \"vulnPubDate\": \"788961600\",\n                \"cvssV3Vector\": \"AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N\",\n                \"patchPubDate\": \"-1\",\n                \"stigSeverity\": \"\",\n                \"pluginModDate\": \"1682596800\",\n                \"pluginPubDate\": \"933508800\",\n                \"temporalScore\": \"\",\n                \"hostUniqueness\": \"repositoryID,ip,dnsName\",\n                \"cvssV3BaseScore\": \"0.0\",\n                \"operatingSystem\": \"Microsoft Windows Server 2016 Datacenter Build 14393\",\n                \"exploitAvailable\": \"No\",\n                \"hasBeenMitigated\": \"0\",\n                \"exploitFrameworks\": \"\",\n                \"assetExposureScore\": \"691\",\n                \"cvssV3TemporalScore\": \"\",\n                \"acceptRiskRuleComment\": \"\",\n                \"recastRiskRuleComment\": \"\"\n            }                \n        ],\n        \"asset_param\": \"{{vars.asset_ip}}\"\n    },\n    \"status\": \"Success\",\n    \"message\": \"\",\n    \"operation\": null,\n    \"execution_time\": \"2 seconds 70 ms\"\n}",
                "operationTitle": "List Asset Vulnerabilities",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "435",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "30f76973-bbff-4a5b-96dc-cd436167bba9"
            },
            {
              "@type": "WorkflowStep",
              "name": "Manage Vulnerabilities Status",
              "description": null,
              "arguments": {
                "arguments": {
                  "asset_data": "{{vars.steps.Get_Vulnerabilities.data}}"
                },
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": false,
                "pass_input_record": false,
                "workflowReference": "/api/3/workflows/ba979482-fe37-422c-8de5-892816cb1c8f"
              },
              "status": null,
              "top": "570",
              "left": "650",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "63436c58-f32f-4308-9a77-b2ddac7d8003"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set parameters",
              "description": null,
              "arguments": {
                "asset_ip": "{{vars.input.params.asset. iPAddress or vars.source_data.ip}}",
                "scan_name": "{{vars.source_data.scan_name}}"
              },
              "status": null,
              "top": "300",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "8a3db71b-8c32-4b5e-bf8a-cc1a3d1306db"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  },
                  "useMockOutput": "{{vars.input.params.useMockOutput}}"
                }
              },
              "status": null,
              "top": "30",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "9b81220c-ee95-4420-9f17-5b9c2d6e1bab"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Compute Vulnerabilities List -> Create Vulnerabilities Records",
              "targetStep": "/api/3/workflow_steps/95e4adce-e4dd-4b28-b63b-b91d86f978f6",
              "sourceStep": "/api/3/workflow_steps/ca7ef5fd-2d16-4fbc-890a-c4053c810627",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "85d964f4-75c0-4465-b6ea-6dca91e4bde6"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Set parameters",
              "targetStep": "/api/3/workflow_steps/8a3db71b-8c32-4b5e-bf8a-cc1a3d1306db",
              "sourceStep": "/api/3/workflow_steps/613e0712-c551-4ed6-aa34-5091a7f2da14",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "d9db24c0-80a0-4766-a61d-90153b2ea76e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Vulnerabilities -> Compute Vulnerabilities List",
              "targetStep": "/api/3/workflow_steps/ca7ef5fd-2d16-4fbc-890a-c4053c810627",
              "sourceStep": "/api/3/workflow_steps/30f76973-bbff-4a5b-96dc-cd436167bba9",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "73037bc1-6399-461e-8da1-b779e2b08416"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Vulnerabilities -> Manage Vulnerabilities Status",
              "targetStep": "/api/3/workflow_steps/63436c58-f32f-4308-9a77-b2ddac7d8003",
              "sourceStep": "/api/3/workflow_steps/30f76973-bbff-4a5b-96dc-cd436167bba9",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "3413eef5-c589-4c01-b867-5168d9a03a05"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set parameters -> Get Vulnerabilities",
              "targetStep": "/api/3/workflow_steps/30f76973-bbff-4a5b-96dc-cd436167bba9",
              "sourceStep": "/api/3/workflow_steps/8a3db71b-8c32-4b5e-bf8a-cc1a3d1306db",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "1f8d08fd-e35d-4297-a08f-3a70f669481c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/613e0712-c551-4ed6-aa34-5091a7f2da14",
              "sourceStep": "/api/3/workflow_steps/9b81220c-ee95-4420-9f17-5b9c2d6e1bab",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "d3d8a205-1852-4715-9db4-e31e1c2c0d05"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "8b54afe5-ad7e-482b-80b6-59ce66fb6a56",
          "id": 1693,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "security-center"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": ">> Manage Vulnerabilities Status",
          "aliasName": null,
          "tag": "#security-center #dataingestion",
          "description": "Unlink resolved vulnerabilities from assets",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "asset_data"
          ],
          "synchronous": false,
          "lastModifyDate": 1694429729,
          "collection": "/api/3/workflow_collections/99c63c4a-fe5d-4141-b391-8f920cdc791b",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/b94bf2f7-f567-4bbe-915a-17213522ec85",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Compute Lists",
              "description": null,
              "arguments": {
                "linked_vulnerabilities": "{{vars.steps.Find_Asset[0].vulnerabilities|json_query(\"[][\\\"@id\\\"][]\")}}",
                "_tmp_find_missing_vulnerabilities": "{%if vars.steps.Find_Asset.0.vulnerabilities|length > 0 %}\n{%for vuln in vars.steps.Find_Asset.0.vulnerabilities %}\n{% if vuln.vulnerabilityId not in vars.plugin_id_list%}\n{{vars.vuln_to_unlink.append(vuln[\"@id\"])}}\n{% endif %}\n{% endfor %}\n{% endif %}"
              },
              "status": null,
              "top": "435",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "da9c0bd8-133f-494e-82f9-c517fe2705a6"
            },
            {
              "@type": "WorkflowStep",
              "name": "Compute Remaining Vulnerabilities",
              "description": null,
              "arguments": {
                "vulnerabilities": "{{vars.linked_vulnerabilities | difference(vars.vuln_to_unlink)}}"
              },
              "status": null,
              "top": "570",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "69b36905-6343-4b12-9855-09bbe57f6c5b"
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "asset_ip": "{{vars.input.params.asset_data.asset_param}}",
                "plugin_id_list": "{{vars.input.params.asset_data.vulns_data|json_query(\"[].pluginID\")}}",
                "vuln_to_unlink": "[]"
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "eca0a196-5a38-4ce0-8361-c2f437159288"
            },
            {
              "@type": "WorkflowStep",
              "name": "Find Asset",
              "description": null,
              "arguments": {
                "query": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "ip",
                      "value": "{{vars.asset_ip}}",
                      "operator": "eq",
                      "_operator": "eq"
                    }
                  ],
                  "__selectFields": [
                    "vulnerabilities"
                  ]
                },
                "module": "assets?$limit=1&$relationships=true&$fsr_max_relation_count=100",
                "checkboxFields": true,
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928770",
              "group": null,
              "uuid": "e9018788-4947-4fa4-a70d-74981b8b9eb2"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "b94bf2f7-f567-4bbe-915a-17213522ec85"
            },
            {
              "@type": "WorkflowStep",
              "name": "Unlink Vulnerabilities",
              "description": null,
              "arguments": {
                "resource": {
                  "vulnerabilities": "{{vars.vulnerabilities}}"
                },
                "operation": "Overwrite",
                "collection": "{{vars.steps.Find_Asset[0]['@id']}}",
                "__recommend": [],
                "collectionType": "/api/3/assets",
                "fieldOperation": [],
                "step_variables": []
              },
              "status": null,
              "top": "705",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "group": null,
              "uuid": "0f82f3ac-ba5c-4974-92a1-9371c9f43061"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Compute Lists -> Compute Remaining Vulnerabilities",
              "targetStep": "/api/3/workflow_steps/69b36905-6343-4b12-9855-09bbe57f6c5b",
              "sourceStep": "/api/3/workflow_steps/da9c0bd8-133f-494e-82f9-c517fe2705a6",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "ba6fcacd-06f1-457b-88dc-22829728a6b2"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Compute Remaining Vulnerabilities -> Unlink Vulnerabilities",
              "targetStep": "/api/3/workflow_steps/0f82f3ac-ba5c-4974-92a1-9371c9f43061",
              "sourceStep": "/api/3/workflow_steps/69b36905-6343-4b12-9855-09bbe57f6c5b",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "9e0f40ff-646b-45ff-8f71-f9c70df64a3e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Find Asset Vulnerabilities",
              "targetStep": "/api/3/workflow_steps/e9018788-4947-4fa4-a70d-74981b8b9eb2",
              "sourceStep": "/api/3/workflow_steps/eca0a196-5a38-4ce0-8361-c2f437159288",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "4bd5765c-ac85-47b4-af8f-517f58f1fa67"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Find Asset Vulnerabilities -> Compute Lists",
              "targetStep": "/api/3/workflow_steps/da9c0bd8-133f-494e-82f9-c517fe2705a6",
              "sourceStep": "/api/3/workflow_steps/e9018788-4947-4fa4-a70d-74981b8b9eb2",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "75d749a2-78b2-4ff9-bf0f-3afbe48dc5f0"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/eca0a196-5a38-4ce0-8361-c2f437159288",
              "sourceStep": "/api/3/workflow_steps/b94bf2f7-f567-4bbe-915a-17213522ec85",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "49190aaf-9a4f-4e92-a63a-2c0e9b4dec51"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "ba15e3ce-89e7-4b33-aed0-feaa0c49771f",
          "id": 1694,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "security-center"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": ">> Update Resolved Vulnerabilities",
          "aliasName": null,
          "tag": "#security-center #dataingestion",
          "description": "Update resolved vulnerabilities from assets",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "asset_data"
          ],
          "synchronous": false,
          "lastModifyDate": 1694429729,
          "collection": "/api/3/workflow_collections/99c63c4a-fe5d-4141-b391-8f920cdc791b",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/c3064da6-0e53-47ee-821b-1da995e1e38c",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Compute Lists",
              "description": null,
              "arguments": {
                "linked_vulnerabilities": "{{vars.steps.Find_Asset[0].vulnerabilities|json_query(\"[][\\\"@id\\\"][]\")}}",
                "_tmp_find_missing_vulnerabilities": "{%if vars.steps.Find_Asset.0.vulnerabilities|length > 0 %}\n{%for vuln in vars.steps.Find_Asset.0.vulnerabilities %}\n{% if vuln.vulnerabilityId not in vars.plugin_id_list%}\n{{vars.vuln_to_unlink.append(vuln[\"@id\"])}}\n{% endif %}\n{% endfor %}\n{% endif %}"
              },
              "status": null,
              "top": "435",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "0c7fc33d-12f5-4cf9-b455-115e6e299310"
            },
            {
              "@type": "WorkflowStep",
              "name": "Compute Remaining Vulnerabilities",
              "description": null,
              "arguments": {
                "vulnerabilities": "{{vars.linked_vulnerabilities | difference(vars.vuln_to_unlink)}}"
              },
              "status": null,
              "top": "570",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "7adebf73-1d85-49ec-8c83-e279c6c625f6"
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "asset_ip": "{{vars.input.params.asset_data.asset_param}}",
                "plugin_id_list": "{{vars.input.params.asset_data.vulns_data|json_query(\"[].pluginID\")}}",
                "vuln_to_unlink": "[]",
                "delete_vulnerabilities": "False"
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "f492bcf5-e76d-4af7-9a5d-eb8f6f4c2540"
            },
            {
              "@type": "WorkflowStep",
              "name": "Delete Resolved Vulnerabilities",
              "description": null,
              "arguments": {
                "when": "{{vars.delete_vulnerabilities and vars.vuln_to_unlink | length > 0}}",
                "params": {
                  "iri": "{{vars.item}}",
                  "body": "",
                  "method": "DELETE"
                },
                "version": "3.2.4",
                "for_each": {
                  "item": "{{vars.vuln_to_unlink}}",
                  "__bulk": false,
                  "parallel": true,
                  "condition": ""
                },
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": []
              },
              "status": null,
              "top": "840",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "a31b721e-cfe9-44b6-8ddc-93ae2e44c60f"
            },
            {
              "@type": "WorkflowStep",
              "name": "Find Asset",
              "description": null,
              "arguments": {
                "query": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "ip",
                      "value": "{{vars.asset_ip}}",
                      "operator": "eq",
                      "_operator": "eq"
                    }
                  ],
                  "__selectFields": [
                    "vulnerabilities"
                  ]
                },
                "module": "assets?$limit=1&$relationships=true&$fsr_max_relation_count=100",
                "checkboxFields": true,
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928770",
              "group": null,
              "uuid": "6b65b214-b00e-4943-bb6f-cba98031f92a"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Status to Resolved",
              "description": null,
              "arguments": {
                "when": "{{vars.vuln_to_unlink | length > 0}}",
                "for_each": {
                  "item": "{{vars.vuln_to_unlink}}",
                  "__bulk": true,
                  "condition": "",
                  "batch_size": 100
                },
                "resource": {
                  "status": "/api/3/picklists/a76c2a3c-272d-4422-adbf-9580900e7c5e"
                },
                "operation": "Append",
                "collection": "{{vars.item}}",
                "__recommend": [],
                "collectionType": "/api/3/vulnerabilities",
                "fieldOperation": {
                  "recordTags": "Append"
                },
                "step_variables": []
              },
              "status": null,
              "top": "705",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "group": null,
              "uuid": "7a88a2be-a4ae-44c6-a62e-c60b0366c5cf"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "c3064da6-0e53-47ee-821b-1da995e1e38c"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Compute Lists -> Compute Remaining Vulnerabilities",
              "targetStep": "/api/3/workflow_steps/7adebf73-1d85-49ec-8c83-e279c6c625f6",
              "sourceStep": "/api/3/workflow_steps/0c7fc33d-12f5-4cf9-b455-115e6e299310",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "1496842f-43ce-4281-8184-e9cfc1c61c2e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Compute Remaining Vulnerabilities -> Set Status to Resolved",
              "targetStep": "/api/3/workflow_steps/7a88a2be-a4ae-44c6-a62e-c60b0366c5cf",
              "sourceStep": "/api/3/workflow_steps/7adebf73-1d85-49ec-8c83-e279c6c625f6",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "50f675c9-fa17-491a-a5b0-f3e17ed809c4"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Find Asset Vulnerabilities",
              "targetStep": "/api/3/workflow_steps/6b65b214-b00e-4943-bb6f-cba98031f92a",
              "sourceStep": "/api/3/workflow_steps/f492bcf5-e76d-4af7-9a5d-eb8f6f4c2540",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "3a8e6238-f578-463f-b76c-f09c8b7438e5"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Find Asset Vulnerabilities -> Compute Lists",
              "targetStep": "/api/3/workflow_steps/0c7fc33d-12f5-4cf9-b455-115e6e299310",
              "sourceStep": "/api/3/workflow_steps/6b65b214-b00e-4943-bb6f-cba98031f92a",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "fd505707-e6eb-4b11-8801-aa92756818b9"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Status to Resolved -> Delete Resolved Vulnerabilities",
              "targetStep": "/api/3/workflow_steps/a31b721e-cfe9-44b6-8ddc-93ae2e44c60f",
              "sourceStep": "/api/3/workflow_steps/7a88a2be-a4ae-44c6-a62e-c60b0366c5cf",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "292185be-d11f-42ee-ad25-a2a64df52cef"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/f492bcf5-e76d-4af7-9a5d-eb8f6f4c2540",
              "sourceStep": "/api/3/workflow_steps/c3064da6-0e53-47ee-821b-1da995e1e38c",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "6ae577fc-b8b2-4e4f-9031-823bd9df1798"
            }
          ],
          "groups": [
            {
              "@type": "WorkflowGroup",
              "name": "Confguration",
              "description": "- If delete_vulnerabilities variable is set to True, resolved vulnerabilities will be deleted from FortiSOAR. Else each fixes vulnerability status will be set to: \n- Resolved -",
              "type": "note",
              "isCollapsed": false,
              "hasTriggerStep": false,
              "hideInLogs": true,
              "metadata": [],
              "reusable": false,
              "top": "120",
              "left": "440",
              "height": "144",
              "width": "304",
              "uuid": "a8110373-2cda-4fea-9e36-5ef6a144ff4d",
              "recordTags": []
            }
          ],
          "priority": null,
          "uuid": "ba979482-fe37-422c-8de5-892816cb1c8f",
          "id": 1695,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "security-center"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "List Completed Scans",
          "aliasName": null,
          "tag": "#Security  Center",
          "description": "List completed scans attributes",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1694429729,
          "collection": "/api/3/workflow_collections/99c63c4a-fe5d-4141-b391-8f920cdc791b",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/ea46a78b-10f1-424a-9498-27ebed4c1ed6",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "66bd8e8e-8c70-471e-aa8b-5b65ef305a0c",
                "title": "SC: List Completed Scan",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": []
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "ea46a78b-10f1-424a-9498-27ebed4c1ed6"
            },
            {
              "@type": "WorkflowStep",
              "name": "List Completed Scans",
              "description": null,
              "arguments": {
                "name": "Tenable Security Center",
                "config": "1c5b1a56-c39b-4b0c-9967-db844016bf9b",
                "params": {
                  "days": "Last 7 Days"
                },
                "version": "1.1.0",
                "connector": "security-center",
                "operation": "get_all_scans",
                "annotation": {
                  "id": 440,
                  "name": "search_scans",
                  "system": false,
                  "category": "investigation",
                  "connectors": [
                    288
                  ],
                  "displayName": "Search Scans",
                  "connectorsData": [
                    {
                      "id": 288,
                      "name": "security-center",
                      "label": "Tenable Security Center",
                      "version": "1.1.0",
                      "operations": [
                        {
                          "title": "List Completed Scans",
                          "operation": "get_all_scans",
                          "description": "Provides all latest completed scans for given time duration"
                        }
                      ]
                    }
                  ]
                },
                "operationTitle": "List Completed Scans",
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "7910c055-7e34-4466-b8bb-69cf9bca9be7"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> List Scans",
              "targetStep": "/api/3/workflow_steps/7910c055-7e34-4466-b8bb-69cf9bca9be7",
              "sourceStep": "/api/3/workflow_steps/ea46a78b-10f1-424a-9498-27ebed4c1ed6",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "f342d752-15fa-45bf-af63-ef1a3df44fba"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "c856376e-5826-478b-a332-ffb7e9e62949",
          "id": 1696,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "security-center"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "TenableSecurityCenter > Ingest",
          "aliasName": null,
          "tag": "#security-center #ingest #dataingestion #create",
          "description": "This playbook fetches scans assets and their associated vulnerabilities",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1694429729,
          "collection": "/api/3/workflow_collections/99c63c4a-fe5d-4141-b391-8f920cdc791b",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/ca3106dc-4f2a-4f6c-952b-8e5a248703a4",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "assets": "{{ vars.result.data }}",
                "scans_iri_map": "{{ vars.result.scans_iri_map }}",
                "records_source_data": "{{ vars.result.source_data }}",
                "assets_assetType_map": "{}",
                "assets_criticality_map": "{}",
                "TenableSecurityCenterMacroName": "{{vars.result.TenableSecurityCenterMacroName}}"
              },
              "status": null,
              "top": "260",
              "left": "400",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "8b6ef9a8-f7f5-42d6-8ed0-de19578f1564"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create or Update Vulnerabilities in Batches",
              "description": null,
              "arguments": {
                "when": "{{vars.steps.Create_Record | length > 0}}",
                "for_each": {
                  "item": "{{vars.steps.Create_Record}}",
                  "__bulk": false,
                  "parallel": true,
                  "condition": ""
                },
                "arguments": {
                  "asset": "{{vars.item}}",
                  "useMockOutput": "{{vars.useMockOutput}}"
                },
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": false,
                "pass_input_record": false,
                "workflowReference": "/api/3/workflows/8b54afe5-ad7e-482b-80b6-59ce66fb6a56"
              },
              "status": null,
              "top": "600",
              "left": "960",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "af30072a-5b5c-4d60-aa8a-bf1fec531489"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Record",
              "description": null,
              "arguments": {
                "when": "{{vars.assets | length > 0}}",
                "for_each": {
                  "item": "{{vars.assets}}",
                  "__bulk": true,
                  "parallel": false,
                  "condition": "",
                  "batch_size": 100
                },
                "resource": {
                  "ip": "{{vars.item.ip}}",
                  "name": "{{vars.item.netbiosName}}",
                  "firmware": "{{vars.item.osCPE}}",
                  "hostname": "{{vars.item.dnsName}}",
                  "location": "{{vars.item.scan_name}}",
                  "__replace": "true",
                  "assetType": "/api/3/picklists/7630b182-4930-4f97-beec-3c3a5372cb3b",
                  "deviceUid": "{{vars.item.uuid}}",
                  "macAddress": "{{vars.item.macAddress}}",
                  "recordTags": [
                    "/api/3/tags/Tenable"
                  ],
                  "sourceData": "{{vars.item|toJSON}}",
                  "criticality": "{% if vars.item.severityCritical|int == 0 %}{{\"Criticality\" | picklist(\"None\", \"@id\")}}{%elif 5 < vars.item.severityCritical|int <= 5 %}{{\"Criticality\" | picklist(\"Low\", \"@id\")}}{%elif 5 < vars.item.severityCritical|int <= 10 %}{{\"Criticality\" | picklist(\"Medium\", \"@id\")}}{%elif 10 < vars.item.severityCritical|int <= 15 %}{{\"Criticality\" | picklist(\"High\", \"@id\")}}{%elif 15 < vars.item.severityCritical|int <= 18 %}{{\"Criticality\" | picklist(\"Critical\", \"@id\")}}{%elif vars.item.severityCritical|int > 18 %}{{\"Criticality\" | picklist(\"Very Critical\", \"@id\")}}{% endif %}",
                  "dateScanned": "{{vars.item.lastAuthRun|int or vars.item.lastUnauthRun|int}}",
                  "description": "{{vars.item | json2html(row_fields=[\"dnsName\",\"ip\",\"macAddress\",\"osCPE\",\"netbiosName\",\"biosGUID\"], display=\"Vertical\")}}",
                  "__fieldsToUpdate": [
                    "dateScanned",
                    "criticality"
                  ]
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "/api/3/upsert/assets",
                "__recommend": [],
                "fieldOperation": {
                  "protocol": "Overwrite",
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "380",
              "left": "580",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "group": null,
              "uuid": "a76d7145-cc6a-48aa-8e17-b1084e941d85"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Records",
              "description": null,
              "arguments": {
                "arguments": {
                  "useMockOutput": "{{vars.useMockOutput}}"
                },
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": false,
                "pass_input_record": false,
                "workflowReference": "/api/3/workflows/260009b3-c48d-4aeb-8220-92197833194e"
              },
              "status": null,
              "top": "140",
              "left": "220",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "2035d41d-e220-42e9-b47e-33aea07bd097"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "24b1e56c-a550-44af-badc-92aa21e50c95",
                "title": "Security Center > Ingest",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  },
                  "useMockOutput": "True"
                },
                "displayConditions": {
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "incidents": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "showToasterMessage": {
                  "visible": false,
                  "messageVisible": true
                },
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "ca3106dc-4f2a-4f6c-952b-8e5a248703a4"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Assets",
              "description": null,
              "arguments": {
                "when": "{{vars.steps.Create_Record | length > 0}}",
                "for_each": {
                  "item": "{{vars.steps.Create_Record}}",
                  "__bulk": true,
                  "parallel": false,
                  "condition": "",
                  "batch_size": 100
                },
                "resource": {
                  "__link": {
                    "scans": "{{vars.scans_iri_map[vars.item.location]}}"
                  }
                },
                "operation": "Append",
                "collection": "{{vars.item[\"@id\"]}}",
                "__recommend": [],
                "collectionType": "/api/3/assets",
                "fieldOperation": {
                  "recordTags": "Append"
                },
                "step_variables": []
              },
              "status": null,
              "top": "500",
              "left": "780",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "group": null,
              "uuid": "54748915-e44a-48f2-a498-29d5adf31df0"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Fetch from X Days Ago",
              "description": null,
              "arguments": {
                "params": {
                  "macro": "{{vars.TenableSecurityCenterMacroName}}",
                  "value": "{{vars.steps.Get_Records.last_x_days}}"
                },
                "version": "3.2.4",
                "connector": "cyops_utilities",
                "operation": "updatemacro",
                "operationTitle": "FSR: Update Global Variables",
                "step_variables": []
              },
              "status": null,
              "top": "700",
              "left": "1160",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "ff3bc6da-dc68-4e44-9163-8376f7b168ce"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Create or Update Assets",
              "targetStep": "/api/3/workflow_steps/a76d7145-cc6a-48aa-8e17-b1084e941d85",
              "sourceStep": "/api/3/workflow_steps/8b6ef9a8-f7f5-42d6-8ed0-de19578f1564",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "b8df6664-6545-4818-b6ec-8e27b24ff1e6"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create or Update Vulnerabilities in Batches -> Update Fetch from X Days Ago",
              "targetStep": "/api/3/workflow_steps/ff3bc6da-dc68-4e44-9163-8376f7b168ce",
              "sourceStep": "/api/3/workflow_steps/af30072a-5b5c-4d60-aa8a-bf1fec531489",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "58bb186d-70e6-4cb3-9d88-bd90e66d98d0"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create Record -> Update Assets",
              "targetStep": "/api/3/workflow_steps/54748915-e44a-48f2-a498-29d5adf31df0",
              "sourceStep": "/api/3/workflow_steps/a76d7145-cc6a-48aa-8e17-b1084e941d85",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "f3b725ba-4761-47ce-9d4f-829b76681c6e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "List Incident -> Config",
              "targetStep": "/api/3/workflow_steps/8b6ef9a8-f7f5-42d6-8ed0-de19578f1564",
              "sourceStep": "/api/3/workflow_steps/2035d41d-e220-42e9-b47e-33aea07bd097",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "ff7fb4f5-71e3-4523-89ab-4f12289aa325"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> List Incident",
              "targetStep": "/api/3/workflow_steps/2035d41d-e220-42e9-b47e-33aea07bd097",
              "sourceStep": "/api/3/workflow_steps/ca3106dc-4f2a-4f6c-952b-8e5a248703a4",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "15a7e7bc-d7ee-45f5-8184-306945e222bf"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Update Assets -> Create or Update Vulnerabilities in Batches",
              "targetStep": "/api/3/workflow_steps/af30072a-5b5c-4d60-aa8a-bf1fec531489",
              "sourceStep": "/api/3/workflow_steps/54748915-e44a-48f2-a498-29d5adf31df0",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "a3b62484-d5f2-4651-bd11-d32a85d68e39"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "c9cb52b4-69c1-47b3-96f0-176cba58a282",
          "id": 1697,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "create",
            "ingest",
            "security-center"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": ">> Create or Update Scans",
          "aliasName": null,
          "tag": "#security-center #dataingestion",
          "description": "Creates new scan and updates existing ones",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "scans_list"
          ],
          "synchronous": false,
          "lastModifyDate": 1694429729,
          "collection": "/api/3/workflow_collections/99c63c4a-fe5d-4141-b391-8f920cdc791b",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/4f1d6e11-2093-4f79-8cad-6faecb4f7c32",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Compute Scan IRIs",
              "description": null,
              "arguments": {
                "_compute_map": "{% for scan in vars.steps.Create_or_Update_Scans %}\n{{vars.scans_iri_map.update({scan.name:scan[\"@id\"]})}}\n{% endfor %}"
              },
              "status": null,
              "top": "435",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "67319edc-07a3-4414-be80-20d79f19e20c"
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "scans": "{% if (vars.input.params.scans_list | type_debug ) == \"dict\" %}{{vars.input.params.scans_list.values()|list}}{%endif%}",
                "scan_names": "{{vars.input.params.scans_list.keys()|list}}",
                "scans_iri_map": "{}",
                "import_status_map": "{\n    \"No Results\": \"No\",\n    \"Import Pending\": \"No\",\n    \"Importing\": \"No\",\n    \"Finished\": \"Yes\",\n    \"Blocked\": \"No\",\n    \"Error\": \"No\"\n}"
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "c6ca17b8-e716-48c0-8d13-fb9fac0ed109"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create or Update Scans",
              "description": null,
              "arguments": {
                "when": "{{vars.scans | length > 0}}",
                "for_each": {
                  "item": "{{vars.scans}}",
                  "__bulk": true,
                  "parallel": false,
                  "condition": "",
                  "batch_size": 100
                },
                "resource": {
                  "name": "{{vars.item.name}}",
                  "state": "{{vars.item.status}}",
                  "scanId": "{{vars.item.id}}",
                  "source": "Tenable",
                  "userId": "{{vars.item.owner.username}}",
                  "duration": "{{vars.item.finishTime|int - vars.item.startTime|int}}",
                  "__replace": "true",
                  "recordTags": [
                    "/api/3/tags/Tenable"
                  ],
                  "launchDateTime": "{{vars.item.startTime|int}}",
                  "scanReferenceID": "{{vars.item.id}}",
                  "__fieldsToUpdate": [
                    "isIngestionCompleted",
                    "duration",
                    "launchDateTime",
                    "state",
                    "userId"
                  ],
                  "isIngestionCompleted": "{{\"YesNoInput\" | picklist(vars.import_status_map[vars.item.importStatus], \"@id\")}}"
                },
                "operation": "Overwrite",
                "collection": "/api/3/upsert/scans",
                "__recommend": [],
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "group": null,
              "uuid": "1e7d4619-bec4-464f-bea2-bb095ff128f6"
            },
            {
              "@type": "WorkflowStep",
              "name": "Return Data",
              "description": null,
              "arguments": {
                "scans_iri_map": "{{vars.scans_iri_map}}"
              },
              "status": null,
              "top": "570",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "a6fc5eac-5fee-4375-ad5f-cf4e85195df8"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  },
                  "scans_list": "{{vars.input.params['scans_list']}}"
                }
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "4f1d6e11-2093-4f79-8cad-6faecb4f7c32"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Compute Scan IRIs -> Return Data",
              "targetStep": "/api/3/workflow_steps/a6fc5eac-5fee-4375-ad5f-cf4e85195df8",
              "sourceStep": "/api/3/workflow_steps/67319edc-07a3-4414-be80-20d79f19e20c",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "507864b4-a21b-4057-ab37-d65600a51281"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Create",
              "targetStep": "/api/3/workflow_steps/1e7d4619-bec4-464f-bea2-bb095ff128f6",
              "sourceStep": "/api/3/workflow_steps/c6ca17b8-e716-48c0-8d13-fb9fac0ed109",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "346b544d-e3ff-403d-91de-5518015e0125"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create -> Compute Results",
              "targetStep": "/api/3/workflow_steps/67319edc-07a3-4414-be80-20d79f19e20c",
              "sourceStep": "/api/3/workflow_steps/1e7d4619-bec4-464f-bea2-bb095ff128f6",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "e7368f4e-01b2-4b6b-972e-750ef1e0451c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/c6ca17b8-e716-48c0-8d13-fb9fac0ed109",
              "sourceStep": "/api/3/workflow_steps/4f1d6e11-2093-4f79-8cad-6faecb4f7c32",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "6b237ca4-c79b-4b5b-bbc5-4d62597d3695"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "ccf4ad7d-4193-4dd9-8ffb-e723620f394b",
          "id": 1698,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "security-center"
          ]
        }
      ]
    }
  ],
  "exported_tags": [
    "security-center",
    "dataingestion",
    "fetch",
    "create",
    "ingest"
  ]
}